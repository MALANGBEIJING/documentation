:show-content:
===========
考勤管理
===========

Odoo 的 *考勤管理* 应用程序充当时间打卡工具。员工可以使用专用设备在 kiosk 模式下进行上下班打卡，用户也可以直接从数据库中进行上下班打卡。管理者可以快速查看当前的可用人员，创建报告以查看所有人的工作时间，并获得有关哪些员工加班或提前下班的见解。

.. _attendances/access-rights:

访问权限
=============

了解不同访问权限如何影响用户在 *考勤管理* 应用程序中可访问的选项和功能非常重要。

数据库中的每个用户都可以直接从数据库中上下班打卡，而无需访问 *考勤管理* 应用程序。此外，所有用户都可以通过 *员工* 应用程序从他们的员工表单中访问自己的考勤记录。

访问 *考勤管理* 应用程序及其中各种功能的权限由访问权限决定。

要查看用户拥有的访问权限，请导航至 :menuselection:`设置应用程序 --> 用户与公司: 用户`，然后点击单个用户。:guilabel:`访问权限` 选项卡会默认显示。向下滚动到 :guilabel:`人力资源` 部分查看设置。在 :guilabel:`考勤管理` 字段中，可以选择留空或选择 :guilabel:`管理员`。

如果选择了 :guilabel:`管理员` 选项，则用户拥有对整个 *考勤管理* 应用程序的完整访问权限，没有任何限制。他们可以查看所有员工的考勤记录，进入 *Kiosk 模式*，访问所有的报告指标，并对设置进行修改。如果留空，则该用户**没有**对 *考勤管理* 应用程序的访问权限。

.. _attendances/approvers:

审批人
---------

*考勤管理* 应用程序中的唯一其他场景是审批人。如果用户没有 *考勤管理* 应用程序的管理权限，但他们被设置为某个员工的 *考勤管理* 应用程序审批人，那么该用户可以查看该特定员工的考勤记录，并在必要时修改该员工的考勤记录。这适用于所有指定该用户为 *考勤管理* 应用程序审批人的员工。审批人通常是经理，但这不是必须的。

要查看某个员工的考勤审批人是谁，请导航至 :menuselection:`员工应用程序`，点击该特定员工。点击 :guilabel:`工作信息` 选项卡，滚动到 :guilabel:`审批人` 部分，并检查 :guilabel:`考勤` 字段。所选人员可以查看该员工的考勤记录，无论是在 *考勤管理* 应用程序仪表板上，还是在考勤报告中，并可对其记录进行修改。

配置
=============

在 *考勤管理* 应用程序中需要进行的配置较少。确定员工如何上下班打卡，定义 kiosk 的功能，以及确定如何计算额外工时，这些都在配置菜单中设置。请导航至 :menuselection:`考勤管理应用程序 --> 配置` 访问配置菜单。

模式
-----

- :guilabel:`从后台考勤`: 激活此选项允许用户直接从 Odoo 数据库上下班打卡。如果未激活此选项，则用户必须使用 kiosk 进行上下班打卡。

额外工时
-----------

此部分指定如何计算额外时间，包括何时计算额外时间以及哪些时间不记录。

- :guilabel:`额外工时统计`: 启用此选项允许员工记录超出其设定工作时间的额外工时（有时称为*加班*）。激活此选项后还会显示以下设置。如果未激活此选项，则不会出现其他配置。

  - :guilabel:`开始日期`: 当前日期会自动填入此字段。如果需要，请点击此字段并使用日历选择器修改额外工时记录的开始日期。
  - :guilabel:`公司容忍时间`: 输入不计入员工加班的时间，以分钟为单位。当员工下班打卡时，如果额外时间少于规定的分钟数，则不会将这些时间计为员工的加班时间。
  - :guilabel:`员工容忍时间`: 输入员工获得的容忍时间，以分钟为单位，当员工记录的时间少于其工作时间时，不会对其考勤产生不利影响。如果员工下班打卡时，当天记录的总时间少于其规定的工作时间，并且少于该指定的宽限期，则不会因工时不足而受到处罚。

    .. example::
       公司将两个 :guilabel:`容忍时间` 字段都设置为 `15` 分钟，公司全体员工的工作时间为上午 9:00 至下午 5:00。

       如果员工在上午 9:00 打卡上班，下午 5:14 打卡下班，则额外的 14 分钟**不**计为加班时间。

       如果员工在上午 9:05 打卡上班，下午 4:55 打卡下班，即使他们的工作时间比规定的工作时间少了 10 分钟，也不会因为这一差异而受到处罚。

  - :guilabel:`显示额外工时`: 启用此选项可在员工通过 kiosk 或用户在数据库中下班打卡时显示员工记录的额外工时。

.. note::
   即使未激活 :guilabel:`额外工时统计` 选项，员工仍然可以记录加班工时。不同之处在于，激活 :guilabel:`额外工时统计` 后，额外的工时可以从批准的休假请求中扣除。

概览
========

进入 *考勤管理* 应用程序时，系统会显示 :guilabel:`概览` 仪表板，包含已登录用户的上下班打卡信息。如果用户具有特定的 :ref:`访问权限 <attendances/access-rights>` 和/或是某些员工的 :ref:`审批人 <attendances/approvers>`，则这些员工的上下班打卡信息也会显示在 :guilabel:`概览` 仪表板中。

视图
-----

要将视图从默认的甘特图切换为列表视图，请点击位于仪表板右上角用户照片下方的 :guilabel:`列表` 图标。要切换回甘特图，请点击 :guilabel:`甘特图` 按钮，位于 :guilabel:`列表` 按钮旁边。

默认视图显示当前日期的信息。要显示 :guilabel:`周`，:guilabel:`月` 或 :guilabel:`年` 的信息，请点击 :guilabel:`日` 按钮以显示下拉菜单，选择其他选项。选择所需视图后，仪表板将更新，显示选定的信息。要更改显示的 :guilabel:`日`，:guilabel:`周`，:guilabel:`月` 或 :guilabel:`年`，请点击下拉菜单两侧的 :guilabel:`← (左箭头)` 或 :guilabel:`→ (右箭头)` 按钮。要跳回包含当前日期的视图，请点击 :guilabel:`今日` 按钮。此操作将刷新仪表板，显示包含当天信息的视图。

在 :guilabel:`日` 视图中，当前小时的列以黄色突出显示。如果选择了 :guilabel:`周` 或 :guilabel:`月` 视图，则当前日期的列被突出显示。如果选择了 :guilabel:`年` 视图，则当前月份被突出显示。

.. image:: attendances/overview.png
   :align: center
   :alt: 概览仪表板显示了本周的信息，当前日期已突出显示。

任何有错误的记录会以红色显示，表示需要由具有适当 :ref:`访问权限 <attendances/access-rights>` 的用户和/或是员工的 :ref:`审批人 <attendances/approvers>` 进行处理。

.. _attendances/filters-groups:

筛选和分组
------------------

要在概览仪表板中过滤结果或显示不同的信息组，请点击仪表板上方 :guilabel:`搜索` 栏右侧的 :guilabel:`🔻 (下拉三角)` 按钮，并选择一个可用的 :guilabel:`筛选器` 或 :guilabel:`分组依据` 选项。有几个预配置的筛选器和分组可供选择，此外还有创建自定义选项的功能。

筛选器
~~~~~~~

可以选择的默认筛选器包括：

- :guilabel:`我的考勤`: 仅显示用户的考勤数据。
- :guilabel:`我的团队`: 显示用户团队的考勤数据。
- :guilabel:`上班中`: 显示当前已打卡上班的人员考勤数据。
- :guilabel:`错误`: 显示有需要解决的 :ref:`错误 <attendances/errors>` 的考勤记录。
- :guilabel:`打卡`: 提供下拉菜单供选择特定的时间段。选择所需的时间段，例如某个月、某个季度或某一年。
- :guilabel:`最近7天`: 显示最近七天的考勤数据。
- :guilabel:`添加自定义筛选器`: 选择此选项后，会弹出窗口创建自定义筛选器。

分组
~~~~~~

可以选择的默认分组包括：

- :guilabel:`打卡`: 此分组提供下拉菜单，包含以下时间段选项：:guilabel:`年`，:guilabel:`季度`，:guilabel:`月`，:guilabel:`周` 和 :guilabel:`日`。选择所需时间段以显示按该时间段分组的打卡信息。
- :guilabel:`员工`: 此分组按员工组织考勤数据。
- :guilabel:`下班`: 此分组提供下拉菜单，包含以下时间段选项：:guilabel:`年`，:guilabel:`季度`，:guilabel:`月`，:guilabel:`周` 和 :guilabel:`日`。选择所需时间段以显示按该时间段分组的下班信息。
- :guilabel:`添加自定义分组`: 此选项显示下拉菜单，可以按多种选项分组考勤数据，包括 :guilabel:`城市`，:guilabel:`国家`，:guilabel:`模式` 和 :guilabel:`IP地址`。

.. _attendances/errors:

考勤记录详细信息
----------------------

Odoo 记录用户上下班打卡时的各种时间和位置信息。提供的具体信息由用户打卡的方式决定。

要查看员工的具体打卡信息，请点击概览仪表板中的某条考勤记录。

系统会弹出一个窗口，显示该用户的详细考勤记录。要关闭详细考勤记录，点击表单左下角的 :guilabel:`保存并关闭` 按钮。

详细考勤记录包含以下信息：

主要信息
~~~~~~~~~~~~

- :guilabel:`员工`: 员工姓名。
- :guilabel:`打卡时间`: 员工打卡的日期和时间。
- :guilabel:`下班时间`: 员工下班的日期和时间。仅当员工已下班时显示此项。
- :guilabel:`工作时长`: 员工当天记录的总时间，以小时和分钟格式（HH:MM）显示。如果员工当天多次打卡上下班，则计算所有打卡时间。
- :guilabel:`额外时长`: 员工超出预期工作时长的额外时间。

打卡/下班详细信息
~~~~~~~~~~~~~~~~~~~~~~~~~~

以下信息同时显示在 :guilabel:`打卡` 和 :guilabel:`下班` 部分。

- :guilabel:`模式`: 考勤信息的记录方式。如果员工是通过 :ref:`直接从数据库打卡 <attendances/check-in>`，则显示 :guilabel:`Systray`；如果员工通过 :ref:`使用考勤 kiosk 打卡 <attendances/kiosk-mode-entry>`，则显示 :guilabel:`手动`。
- :guilabel:`IP 地址`: 员工打卡或下班时使用的计算机的 IP 地址。
- :guilabel:`浏览器`: 员工打卡或下班时使用的网页浏览器。
- :guilabel:`地理位置`: 与计算机 IP 地址相关的城市和国家。
- :guilabel:`GPS 坐标`: 用户打卡或下班时的具体坐标。要在地图上查看具体坐标，请点击 :guilabel:`→ 在地图上查看` 按钮，此操作会在新浏览器标签页中打开地图，并显示具体位置。

.. image:: attendances/details.png
   :align: center
   :alt: 考勤记录的详细信息。

错误
------

包含错误的记录会在概览仪表板上以红色显示。在 :guilabel:`甘特图` 视图中，记录的背景为红色。如果在 :guilabel:`列表视图` 中，记录的文本显示为红色。

当员工打卡后 24 小时内未下班，或当员工打卡和下班时间超过 16 小时时，通常会出现错误。

要修复错误，必须修改或删除考勤记录。点击该记录会弹出包含该记录详细信息的窗口。要修改 :guilabel:`打卡` 和/或 :guilabel:`下班` 信息，点击 :guilabel:`打卡` 或 :guilabel:`下班` 字段，会出现日历选择器。点击所需日期，然后使用日历下方的时间选择器选择具体时间。当信息正确时，点击 :guilabel:`应用`。

.. image:: attendances/errors.png
   :align: center
   :alt: 允许修改包含错误的考勤记录的弹出窗口。显示了日历选择器，并突出显示了时间选择器。

当弹出窗口中的所有信息都正确后，点击 :guilabel:`保存并关闭`。当记录不再有错误时，记录会显示为灰色，而非红色。

要删除记录，请点击弹出窗口中的 :guilabel:`删除`，而不是修改记录。

报告
=========

要查看考勤报告，请点击顶部菜单中的 :guilabel:`报告`。默认报告会以 :guilabel:`折线图` 显示每位员工过去 3 个月的考勤信息。

默认视图为 :guilabel:`图表`。要以数据透视表形式查看数据，请点击报告右上角的 :guilabel:`数据透视表` 按钮。要切换回图表视图，点击位于 :guilabel:`数据透视表` 按钮旁边的 :guilabel:`图表` 按钮。

要显示不同的信息，请像在 :guilabel:`概览` 仪表板中一样，调整 :ref:`筛选器和分组 <attendances/filters-groups>`。

数据可以以 :guilabel:`柱状图`，:guilabel:`折线图`，:guilabel:`饼图`，:guilabel:`堆叠图` 显示，或以 :guilabel:`降序` 或 :guilabel:`升序` 排列。要切换为这些图表中的任何一种，请点击显示的图表上方的相应按钮。

要更改 :guilabel:`度量标准`，点击 :guilabel:`度量标准` 按钮，然后从下拉菜单中选择所需的度量标准。

报告还可以插入到电子表格中。点击 :guilabel:`插入到电子表格` 按钮，会弹出一个窗口。选择所需的电子表格，然后点击 :guilabel:`确认`。

.. image:: attendances/reporting.png
   :align: center
   :alt: 默认报告视图，突出显示了所有可选视图按钮。

.. seealso::
   - :doc:`attendances/check_in_check_out`
   - :doc:`attendances/kiosks`
   - :doc:`attendances/hardware`

.. toctree::
   :titlesonly:

   attendances/check_in_check_out
   attendances/kiosks
   attendances/hardware
