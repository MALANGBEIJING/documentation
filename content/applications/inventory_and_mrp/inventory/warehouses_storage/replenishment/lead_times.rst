==========
交货时间
==========

.. |MOs| replace:: :abbr:`MOs (生产订单)`
.. |BoM| replace:: :abbr:`BoM (物料清单)`
.. |BoMs| replace:: :abbr:`BoMs (物料清单)`
.. |RFQ| replace:: :abbr:`RFQ (询价单)`

准确预测交货日期对于满足客户期望至关重要。在 Odoo 中，*库存* 应用允许全面配置交货时间，以协调和计划生产订单、交货和接收。

交货时间类型
===============

不同操作的不同交货时间会影响订单履行过程的各个阶段。以下是 Odoo 中交货时间类型的摘要：

.. image:: lead_times/all-lead-times.png
   :align: center
   :alt: 显示所有交货时间如何协同工作。

- :ref:`客户交货时间 <inventory/shipping_receiving/customer-lt>`：履行客户订单的默认时间框架。客户交货时间是从销售订单 (SO) 确认之日起到产品从仓库发货之日的天数。也称为 *交货时间*。

- :ref:`销售安全交货时间 <inventory/shipping_receiving/sales-security-lt>`：将 *计划交货日期* 向前移动指定天数。此操作作为缓冲，以便提前准备发货，考虑到履行过程中可能出现的延误。

- :ref:`采购交货时间 <inventory/shipping_receiving/purchase-lt>`：从采购订单 (PO) 确认到产品接收的天数。它提供了产品到达仓库所需时间的见解，有助于有效安排和计划供应商交货。

- :ref:`采购安全交货时间 <inventory/shipping_receiving/purchase-security-lt>`：将采购订单 (PO) 的截止日期提前指定的天数。这种提前下订单的方法可以减轻供应商或运输延误的风险。因此，对于设置为按订单补充的产品，需求会提前出现在 *补货报告* 中。

- :ref:`采购准备时间 <inventory/shipping_receiving/days-to-purchase>`：供应商收到询价单 (RFQ) 并确认所需的天数。它将安排询价单的截止日期提前指定的天数。

- :ref:`生产交货时间 <inventory/shipping_receiving/manuf-lt>`：从确认生产订单 (MO) 到完成产品所需的天数。此交货时间包括周末（Odoo 中的非工作时间），用于预测成品的预期生产日期。

- :ref:`准备生产订单的天数 <inventory/shipping_receiving/prepare-manufacturing-order>`：补充组件或制造产品的子组件所需的天数。可以直接在物料清单 (BoM) 中设置，也可以点击 *计算* 以汇总物料清单中的采购和生产交货时间。

- :ref:`生产安全交货时间 <inventory/shipping_receiving/manuf-security-lt>`：将生产订单 (MO) 的计划日期提前指定的天数。当与 :ref:`按订单补充 <inventory/management/products/strategies>` 配合使用时，安全交货时间会使需求更早地出现在补货报告中。

.. _inventory/shipping_receiving/customer-lt:

销售交货时间
================

客户交货时间和销售安全交货时间可以配置为在销售订单 (SO) 上自动计算 *预计交货日期*。预计交货日期确保从仓库发货的运输时间有一个现实的 *交货日期* 设置。

如果设置的交货日期早于预计日期，Odoo 会发出警告消息，因为在该时间内履行订单可能不可行，这会影响其他仓库操作。

.. example::
   一个包含 `椰子香味蜡烛` 的销售订单 (SO) 于7月11日确认。该产品的客户交货时间为14天，企业使用1天的销售安全交货时间。根据交货时间输入，Odoo 建议的交货日期为15天后的7月26日。

   .. image:: lead_times/scheduled-date.png
      :align: center
      :alt: 在销售订单中设置 *交货日期*。启用交货时间功能。

以下部分演示如何自动计算预计交货日期。

客户交货时间
------------------

在每个产品表单上设置客户交货时间，方法是导航到产品页面。为此，请前往 :menuselection:`销售应用 --> 产品 --> 产品`。从那里选择所需的产品，并切换到 :guilabel:`库存` 标签。然后，在 :guilabel:`客户交货时间` 字段中填写完成交货订单所需的日历天数。

.. example::
   通过导航到 `椰子香味蜡烛` 的产品表单，将客户交货时间设置为14天。然后，在 :guilabel:`库存` 标签中，在 :guilabel:`客户交货时间` 字段中输入 `14.00` 天。

   .. image:: lead_times/customer.png
      :align: center
      :alt: 在产品表单上设置 *客户交货时间*。

.. _inventory/shipping_receiving/sales-security-lt:

销售安全交货时间
------------------------

*销售安全交货时间* 在企业的 :menuselection:`库存应用 --> 配置 --> 设置` 中全局设置。

在配置页面的 :guilabel:`高级排程` 标题下，找到 :guilabel:`销售安全交货时间` 复选框，并勾选以启用该功能。

接下来，输入所需的日历天数。此安全交货时间是一个缓冲，通知团队提前准备发货，以防万一发货日期提前。

.. example::
   将 :guilabel:`销售安全交货时间` 设置为 `1.00` 天，将交货单 (DO) 的 :guilabel:`计划日期` 提前一天。在这种情况下，如果产品最初计划于4月6日发货，但有1天的安全交货时间，则交货单的新计划日期为4月5日。

   .. image:: lead_times/sales-security.png
      :align: center
      :alt: 从销售设置中查看销售安全交货时间配置。

交付多个产品
------------------------

对于包含多个具有不同交货时间的产品的订单，可以直接从报价单中配置交货时间。在报价单上，点击 :guilabel:`其他信息` 标签，并将 :guilabel:`发货政策` 设置为：

#. :guilabel:`尽快发货`，以便产品准备好后立即发货。交货单 (DO) 的 :guilabel:`计划日期` 由今天的日期加上订单中产品的最短交货时间确定。

#. :guilabel:`所有产品准备好后再发货`，以便一次性履行整个订单。交货单 (DO) 的 :guilabel:`计划日期` 由今天的日期加上订单中产品的最长交货时间确定。

.. image:: lead_times/shipping-policy.png
   :align: center
   :alt: 显示报价单 *其他信息* 标签中的 *发货政策* 字段。

.. example::
   在包含2种产品的报价单中，`瑜伽垫` 和 `阻力带` 的交货时间分别为8天和5天。今天的日期是4月2日。

   当 :guilabel:`发货政策` 设置为 :guilabel:`尽快发货` 时，计划的交货日期为今天起5天后：4月7日。另一方面，选择 :guilabel:`所有产品准备好后再发货` 会将计划日期设置为今天起8天后：4月10日。

.. _inventory/shipping_receiving/purchase-lt:

采购交货时间
===================

自动确定从供应商处下单的日期有助于简化采购过程。

Odoo 根据产品在仓库中需要的日期计算供应商发货的 *接收日期* 和采购订单 (PO) 截止日期。通过从接收日期向前推，考虑供应商交货时间和采购安全交货时间，以确定采购订单 (PO) 截止日期。

该截止日期是为了确保产品按预期接收日期及时到达，订单应确认的日期。

.. image:: lead_times/vendor-lead-times.png
   :align: center
   :alt: 显示供应商交货时间与采购订单截止日期。

.. seealso::
   :ref:`通过补货规则安排采购订单 <inventory/management/reordering_rules>`

供应商交货时间
----------------

要为从供应商地点到达仓库的订单设置供应商交货时间，请通过 :menuselection:`采购应用 --> 产品 --> 产品` 导航到产品表单。

接下来，选择所需产品，并切换到 :guilabel:`采购` 标签。在可编辑的供应商价格表中，点击 :guilabel:`添加一行` 按钮，添加供应商详细信息，如 :guilabel:`供应商` 名称、产品的 :guilabel:`价格`，最后是 :guilabel:`交货时间`。

.. note::
   可以在供应商价格表中添加多个供应商和交货时间。默认选择的供应商和交货时间将是列表顶部的条目。

.. example::
   在产品表单的供应商价格表上，所选供应商的 :guilabel:`交货时间` 设置为 `10天`。

   .. image:: lead_times/set-vendor.png
      :align: center
      :alt: 在产品的供应商价格表中添加交货时间。

通过设置供应商交货时间，预计的物品到货日期自动确定为采购订单 (PO) 确认日期加上供应商交货时间。这确保了如果产品没有在预期时间内到达，仓库员工会收到通知。

.. example::
   对于7月11日确认的采购订单 (PO)，对于配置了10天供应商交货时间的产品，Odoo 会自动将 :guilabel:`接收日期` 设置为7月21日。接收日期也会显示为仓库收货单上的 :guilabel:`计划日期`，可以通过 :guilabel:`接收` 智能按钮从采购订单 (PO) 中访问。

   .. image:: lead_times/receipt-date.png
      :align: center
      :alt: 显示供应商产品的预期 *接收日期*。

   .. image:: lead_times/scheduled-date-receipt.png
      :align: center
      :alt: 显示供应商产品的预期 *到货计划日期*。

.. _inventory/shipping_receiving/purchase-security-lt:

采购安全交货时间
---------------------------

*采购安全交货时间* 在企业的 :menuselection:`库存应用 --> 配置 --> 设置` 中全局设置。

在 :guilabel:`设置` 页面上的 :guilabel:`高级排程` 标题下，勾选 :guilabel:`采购安全交货时间` 复选框。

接下来，输入所需的日历天数。通过配置安全交货时间，可以设置一个缓冲，以应对供应商交货延误的可能性。然后，点击 :guilabel:`保存`。

.. example::
   将 :guilabel:`采购安全交货时间` 设置为 `2.00` 天，将接收的 :guilabel:`计划日期` 推迟两天。在这种情况下，如果产品最初计划于4月6日到达，有两天的安全交货时间，则接收的计划新日期为4月8日。

   .. image:: lead_times/vendor-security.png
      :align: center
      :alt: 在库存 > 配置 > 设置中设置采购安全交货时间。

.. _inventory/shipping_receiving/days-to-purchase:

采购准备时间
----------------

要设置 *采购准备时间*，请前往 :menuselection:`库存应用 --> 配置 --> 设置`。在 :guilabel:`高级排程` 部分的 :guilabel:`采购准备时间` 字段中，指定供应商从公司收到询价单 (RFQ) 并确认所需的天数。

.. image:: lead_times/days-to-purchase.png
   :align: center
   :alt: 在设置页面中显示“采购准备时间”配置。

.. _inventory/shipping_receiving/manuf-lt:

生产交货时间
========================

交货时间有助于简化用于生产产品的消耗材料和组件的采购过程，这些产品具有物料清单 (BoMs)。

通过配置生产交货时间和生产安全交货时间，可以确定生产订单 (MO) 截止日期，即开始生产以在计划交货日期之前完成产品的截止日期。

.. image:: lead_times/manuf-lead-times.png
   :align: center
   :alt: 显示计划的生产交货时间如何确定生产订单 (MO) 日期。

生产交货时间
-----------------------

产品的生产交货时间在产品的物料清单 (BoM) 表单中配置。

要在物料清单 (BoM) 中添加交货时间，请导航到 :menuselection:`生产应用 --> 产品 --> 物料清单`，然后选择所需的物料清单 (BoM) 进行编辑。

在物料清单 (BoM) 表单上，点击 :guilabel:`杂项` 标签。在 :guilabel:`生产交货时间` 字段中更改值（以天为单位），以指定制造产品所需的日历天数。

.. image:: lead_times/set-manufacturing.png
   :align: center
   :alt: 在产品的物料清单表单中指定生产交货时间。

.. note::
   如果所选物料清单 (BoM) 是多层物料清单，则会添加组件的生产交货时间。

   如果物料清单 (BoM) 产品是外包的，则可以使用 :guilabel:`生产交货时间` 来确定应将组件发送给分包商的日期。

根据交货单 (DO) 中指示的 *预计交货日期*，确定生产订单 (MO) 截止日期。

生产订单 (MO) 的截止日期，即生产订单 (MO) 上的 :guilabel:`计划日期` 字段，计算方法为预计交货日期减去生产交货时间。

这确保了生产过程按时开始，以满足交货日期。

然而，需要注意的是，交货时间基于日历天。交货时间 **不** 考虑周末、假期或 *工作中心容量*（:dfn:`工作中心同时可以执行的操作数量`）。

.. seealso::
   - :doc:`生产计划 <../../../manufacturing/workflows/use_mps>`
   - :doc:`使用补货规则安排生产订单 <reordering_rules>`

.. example::
   产品的交货单 (DO) 上的计划发货日期是8月15日。产品需要14天生产。因此，满足承诺日期的最迟开始生产订单 (MO) 日期是8月1日。

.. _inventory/shipping_receiving/prepare-manufacturing-order:

准备生产订单的天数
-----------------------------------

通过进入产品的物料清单 (BoM) 配置生产产品所需组件的准备时间。为此，前往 :menuselection:`生产应用 --> 产品 --> 物料清单`，并选择所需的物料清单 (BoM)。

在物料清单 (BoM) 的 :guilabel:`杂项` 标签中，指定获得产品组件所需的日历天数，在 :guilabel:`准备生产订单的天数` 字段中填写。这样可以提前创建生产订单 (MOs)，并确保有足够的时间来补充组件或制造半成品。

.. tip::
   点击位于 :guilabel:`准备生产订单的天数` 字段旁边的 :guilabel:`计算`，计算物料清单 (BoM) 上所有组件的最长交货时间。

   *采购安全交货时间* 也会添加到此值中。

.. example::

   一个物料清单 (BoM) 有两个组件，一个组件的生产交货时间为两天，另一个组件的采购交货时间为四天。:guilabel:`准备生产订单的天数` 为四天。

.. _inventory/shipping_receiving/manuf-security-lt:

生产安全交货时间
--------------------------------

*生产安全交货时间* 在企业的 :menuselection:`生产应用 --> 配置 --> 设置` 中全局设置。在 :guilabel:`计划` 标题下，勾选 :guilabel:`安全交货时间` 复选框。

接下来，输入所需的日历天数。通过配置安全交货时间，可以设置一个缓冲，以应对生产过程中的潜在延误。然后，点击 :guilabel:`保存`。

.. image:: lead_times/manuf-security.png
   :align: center
   :alt: 从生产应用设置中查看生产安全交货时间。

.. example::
   产品在交货单 (DO) 上的计划发货日期是8月15日。生产交货时间为7天，生产安全交货时间为3天。因此，生产订单 (MO) 上的 :guilabel:`计划日期` 反映了开始生产订单的最迟日期。在此示例中，生产订单 (MO) 上的计划日期是8月5日。

全局示例
==============

请参阅以下示例，了解所有交货时间如何协同工作以确保及时履行订单：

- **销售安全交货时间**：1天
- **生产安全交货时间**：2天
- **生产交货时间**：3天
- **采购安全交货时间**：1天
- **供应商交货时间**：4天

客户在9月1日下单购买一件制造产品，仓库的计划发货日期是9月20日。Odoo 使用交货时间和自动补货规则，根据9月20日的发货日期安排必要的操作：

.. image:: lead_times/global-example.png
   :align: center
   :alt: 显示所有交货时间如何协同工作以安排仓库操作的时间表。

- **9月1日**：销售订单由销售人员创建并确认。

- **9月9日**：下单组件的截止日期，以确保它们在生产开始时及时到达（4天供应商交货时间）。

- **9月13日**：计划的组件接收日期。最初设置为9月14日，但1天的采购安全交货时间将日期提前了1天。

- **9月14日**：开始生产的截止日期。通过从9月19日的预计交货日期中减去3天的生产交货时间和2天的生产安全交货时间来计算。

- **9月19日**：交货单上的 :guilabel:`计划日期` 指示更新后的预计交货日期，最初设置为9月20日。但销售安全交货时间将日期提前了1天。

Odoo 的补货计划映射了企业的订单履行流程，设置了预定的截止日期和原材料订购日期，包括潜在延误的缓冲天数。这确保了产品按时交付。
